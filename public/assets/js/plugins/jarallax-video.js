/*!
 * Name    : Video Worker (wrapper for Youtube, Vimeo and Local videos)
 * Version : 1.2.1
 * Author  : _nK https://nkdev.info
 * GitHub  : https://github.com/nk-o/jarallax
 */
!function(a){"use strict";function b(a){a=a||{};for(var b=1;b<arguments.length;b++)if(arguments[b])for(var c in arguments[b])arguments[b].hasOwnProperty(c)&&(a[c]=arguments[b][c]);return a}function c(){this._done=[],this._fail=[]}function d(a,b,c){a.addEventListener?a.addEventListener(b,c):a.attachEvent("on"+b,function(){c.call(a)})}c.prototype={execute:function(a,b){var c=a.length;for(b=Array.prototype.slice.call(b);c--;)a[c].apply(null,b)},resolve:function(){this.execute(this._done,arguments)},reject:function(){this.execute(this._fail,arguments)},done:function(a){this._done.push(a)},fail:function(a){this._fail.push(a)}};var e=function(){function c(c,d){var e=this;e.url=c,e.options_default={autoplay:1,loop:1,mute:1,controls:0,startTime:0,endTime:0},e.options=b({},e.options_default,d),e.videoID=e.parseURL(c),e.videoID&&(e.ID=a++,e.loadAPI(),e.init())}var a=0;return c}();e.prototype.parseURL=function(a){function b(a){var b=/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/,c=a.match(b);return!(!c||11!==c[1].length)&&c[1]}function c(a){var b=/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/,c=a.match(b);return!(!c||!c[3])&&c[3]}function d(a){for(var b=a.split(/,(?=mp4\:|webm\:|ogv\:|ogg\:)/),c={},d=0,e=0;e<b.length;e++){var f=b[e].match(/^(mp4|webm|ogv|ogg)\:(.*)/);f&&f[1]&&f[2]&&(c["ogv"===f[1]?"ogg":f[1]]=f[2],d=1)}return!!d&&c}var e=b(a),f=c(a),g=d(a);return e?(this.type="youtube",e):f?(this.type="vimeo",f):!!g&&(this.type="local",g)},e.prototype.isValid=function(){return!!this.videoID},e.prototype.on=function(a,b){this.userEventsList=this.userEventsList||[],(this.userEventsList[a]||(this.userEventsList[a]=[])).push(b)},e.prototype.off=function(a,b){if(this.userEventsList&&this.userEventsList[a])if(b)for(var c=0;c<this.userEventsList[a].length;c++)this.userEventsList[a][c]===b&&(this.userEventsList[a][c]=!1);else delete this.userEventsList[a]},e.prototype.fire=function(a){var b=[].slice.call(arguments,1);if(this.userEventsList&&"undefined"!=typeof this.userEventsList[a])for(var c in this.userEventsList[a])this.userEventsList[a][c]&&this.userEventsList[a][c].apply(this,b)},e.prototype.play=function(a){var b=this;b.player&&("youtube"===b.type&&b.player.playVideo&&("undefined"!=typeof a&&b.player.seekTo(a||0),b.player.playVideo()),"vimeo"===b.type&&("undefined"!=typeof a&&b.player.setCurrentTime(a),b.player.getPaused().then(function(a){a&&b.player.play()})),"local"===b.type&&("undefined"!=typeof a&&(b.player.currentTime=a),b.player.play()))},e.prototype.pause=function(){this.player&&("youtube"===this.type&&this.player.pauseVideo&&this.player.pauseVideo(),"vimeo"===this.type&&this.player.pause(),"local"===this.type&&this.player.pause())},e.prototype.getImageURL=function(a){var b=this;if(b.videoImage)return void a(b.videoImage);if("youtube"===b.type){var c=["maxresdefault","sddefault","hqdefault","0"],d=0,e=new Image;e.onload=function(){120!==(this.naturalWidth||this.width)||d===c.length-1?(b.videoImage="https://img.youtube.com/vi/"+b.videoID+"/"+c[d]+".jpg",a(b.videoImage)):(d++,this.src="https://img.youtube.com/vi/"+b.videoID+"/"+c[d]+".jpg")},e.src="https://img.youtube.com/vi/"+b.videoID+"/"+c[d]+".jpg"}if("vimeo"===b.type){var f=new XMLHttpRequest;f.open("GET","https://vimeo.com/api/v2/video/"+b.videoID+".json",!0),f.onreadystatechange=function(){if(4===this.readyState&&this.status>=200&&this.status<400){var c=JSON.parse(this.responseText);b.videoImage=c[0].thumbnail_large,a(b.videoImage)}},f.send(),f=null}},e.prototype.getIframe=function(b){var c=this;return c.$iframe?void b(c.$iframe):void c.onAPIready(function(){function k(a,b,c){var d=document.createElement("source");d.src=b,d.type=c,a.appendChild(d)}var e;if(c.$iframe||(e=document.createElement("div"),e.style.display="none"),"youtube"===c.type){c.playerOptions={},c.playerOptions.videoId=c.videoID,c.playerOptions.playerVars={autohide:1,rel:0,autoplay:0},c.options.controls||(c.playerOptions.playerVars.iv_load_policy=3,c.playerOptions.playerVars.modestbranding=1,c.playerOptions.playerVars.controls=0,c.playerOptions.playerVars.showinfo=0,c.playerOptions.playerVars.disablekb=1);var f,g;c.playerOptions.events={onReady:function(a){c.options.mute&&a.target.mute(),c.options.autoplay&&c.play(c.options.startTime),c.fire("ready",a)},onStateChange:function(a){c.options.loop&&a.data===YT.PlayerState.ENDED&&c.play(c.options.startTime),f||a.data!==YT.PlayerState.PLAYING||(f=1,c.fire("started",a)),a.data===YT.PlayerState.PLAYING&&c.fire("play",a),a.data===YT.PlayerState.PAUSED&&c.fire("pause",a),a.data===YT.PlayerState.ENDED&&c.fire("end",a),c.options.endTime&&(a.data===YT.PlayerState.PLAYING?g=setInterval(function(){c.options.endTime&&c.player.getCurrentTime()>=c.options.endTime&&(c.options.loop?c.play(c.options.startTime):c.pause())},150):clearInterval(g))}};var h=!c.$iframe;if(h){var i=document.createElement("div");i.setAttribute("id",c.playerID),e.appendChild(i),document.body.appendChild(e)}c.player=c.player||new a.YT.Player(c.playerID,c.playerOptions),h&&(c.$iframe=document.getElementById(c.playerID),c.videoWidth=parseInt(c.$iframe.getAttribute("width"),10)||1280,c.videoHeight=parseInt(c.$iframe.getAttribute("height"),10)||720)}if("vimeo"===c.type){c.playerOptions="",c.playerOptions+="player_id="+c.playerID,c.playerOptions+="&autopause=0",c.options.controls||(c.playerOptions+="&badge=0&byline=0&portrait=0&title=0"),c.playerOptions+="&autoplay="+(c.options.autoplay?"1":"0"),c.playerOptions+="&loop="+(c.options.loop?1:0),c.$iframe||(c.$iframe=document.createElement("iframe"),c.$iframe.setAttribute("id",c.playerID),c.$iframe.setAttribute("src","https://player.vimeo.com/video/"+c.videoID+"?"+c.playerOptions),c.$iframe.setAttribute("frameborder","0"),e.appendChild(c.$iframe),document.body.appendChild(e)),c.player=c.player||new Vimeo.Player(c.$iframe),c.player.getVideoWidth().then(function(a){c.videoWidth=a||1280}),c.player.getVideoHeight().then(function(a){c.videoHeight=a||720}),c.player.setVolume(c.options.mute?0:100);var j;c.player.on("timeupdate",function(a){j||c.fire("started",a),j=1,c.options.endTime&&c.options.endTime&&a.seconds>=c.options.endTime&&(c.options.loop?c.play(c.options.startTime):c.pause())}),c.player.on("play",function(a){c.fire("play",a),c.options.startTime&&0===a.seconds&&c.play(c.options.startTime)}),c.player.on("pause",function(a){c.fire("pause",a)}),c.player.on("ended",function(a){c.fire("end",a)}),c.player.on("loaded",function(a){c.fire("ready",a)})}if("local"===c.type){if(!c.$iframe){c.$iframe=document.createElement("video"),c.options.mute&&(c.$iframe.muted=!0),c.options.loop&&(c.$iframe.loop=!0),c.$iframe.setAttribute("id",c.playerID),e.appendChild(c.$iframe),document.body.appendChild(e);for(var l in c.videoID)k(c.$iframe,c.videoID[l],"video/"+l)}c.player=c.player||c.$iframe;var m;d(c.player,"playing",function(a){m||c.fire("started",a),m=1}),d(c.player,"timeupdate",function(){c.options.endTime&&c.options.endTime&&this.currentTime>=c.options.endTime&&(c.options.loop?c.play(c.options.startTime):c.pause())}),d(c.player,"play",function(a){c.fire("play",a)}),d(c.player,"pause",function(a){c.fire("pause",a)}),d(c.player,"ended",function(a){c.fire("end",a)}),d(c.player,"loadedmetadata",function(){c.videoWidth=this.videoWidth||1280,c.videoHeight=this.videoHeight||720,c.fire("ready"),c.options.autoplay&&c.play(c.options.startTime)})}b(c.$iframe)})},e.prototype.init=function(){var a=this;a.playerID="VideoWorker-"+a.ID};var f=0,g=0;e.prototype.loadAPI=function(){var b=this;if(!f||!g){var c="";if("youtube"!==b.type||f||(f=1,c="//www.youtube.com/iframe_api"),"vimeo"!==b.type||g||(g=1,c="//player.vimeo.com/api/player.js"),c){"file://"===a.location.origin&&(c="http:"+c);var d=document.createElement("script"),e=document.getElementsByTagName("head")[0];d.src=c,e.appendChild(d),e=null,d=null}}};var h=0,i=0,j=new c,k=new c;e.prototype.onAPIready=function(b){var c=this;if("youtube"===c.type&&("undefined"!=typeof YT&&0!==YT.loaded||h?"object"==typeof YT&&1===YT.loaded?b():j.done(function(){b()}):(h=1,a.onYouTubeIframeAPIReady=function(){a.onYouTubeIframeAPIReady=null,j.resolve("done"),b()})),"vimeo"===c.type)if("undefined"!=typeof Vimeo||i)"undefined"!=typeof Vimeo?b():k.done(function(){b()});else{i=1;var d=setInterval(function(){"undefined"!=typeof Vimeo&&(clearInterval(d),k.resolve("done"),b())},20)}"local"===c.type&&b()},a.VideoWorker=e}(window);
/*!
 * Name    : Video Background Extension for Jarallax
 * Version : 1.0.0
 * Author  : _nK http://nkdev.info
 * GitHub  : https://github.com/nk-o/jarallax
 */
!function(){"use strict";if("undefined"!=typeof jarallax){var a=jarallax.constructor,b=a.prototype.init;a.prototype.init=function(){var a=this;b.apply(a),a.video&&a.video.getIframe(function(b){var c=b.parentNode;a.css(b,{position:"fixed",top:"0px",left:"0px",right:"0px",bottom:"0px",width:"100%",height:"100%",maxWidth:"none",maxHeight:"none",visibility:"visible",margin:0,zIndex:-1}),a.$video=b,a.image.$container.appendChild(b),c.parentNode.removeChild(c)})};var c=a.prototype.coverImage;a.prototype.coverImage=function(){var a=this;c.apply(a),a.video&&"IFRAME"===a.image.$item.nodeName&&a.css(a.image.$item,{height:a.image.$item.getBoundingClientRect().height+400+"px",marginTop:-200+parseFloat(a.css(a.image.$item,"margin-top"))+"px"})};var d=a.prototype.initImg;a.prototype.initImg=function(){var a=this,b=d.apply(a);if(a.options.videoSrc||(a.options.videoSrc=a.$item.getAttribute("data-jarallax-video")||!1),a.options.videoSrc){var c=new VideoWorker(a.options.videoSrc,{startTime:a.options.videoStartTime||0,endTime:a.options.videoEndTime||0});if(c.isValid()&&(a.image.useImgTag=!0,c.on("ready",function(){var b=a.onScroll;a.onScroll=function(){b.apply(a),a.isVisible()?c.play():c.pause()}}),c.on("started",function(){a.image.$default_item=a.image.$item,a.image.$item=a.$video,a.image.width=a.options.imgWidth=a.video.videoWidth||1280,a.image.height=a.options.imgHeight=a.video.videoHeight||720,a.coverImage(),a.clipContainer(),a.onScroll(),a.image.$default_item&&(a.image.$default_item.style.display="none")}),a.video=c,"local"!==c.type&&c.getImageURL(function(b){a.image.src=b,a.init()})),"local"!==c.type)return!1;if(!b)return a.image.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",!0}return b};var e=a.prototype.destroy;a.prototype.destroy=function(){var a=this;e.apply(a)}}}();